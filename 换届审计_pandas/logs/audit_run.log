2025-07-12 15:29:06,661 - AuditReportLogger - INFO - main.run_audit_report:12 - ========================================
2025-07-12 15:29:06,661 - AuditReportLogger - INFO - main.run_audit_report:13 - ===    自动化审计报告生成流程启动    ===
2025-07-12 15:29:06,661 - AuditReportLogger - INFO - main.run_audit_report:14 - ========================================
2025-07-12 15:29:06,661 - AuditReportLogger - INFO - main.run_audit_report:20 - 源文件路径: C:\审计自动化\my_github_repos\换届审计_pandas\data\soce.xlsx
2025-07-12 15:29:06,662 - AuditReportLogger - INFO - main.run_audit_report:21 - 映射文件路径: C:\审计自动化\my_github_repos\换届审计_pandas\data\mapping_file.xlsx
2025-07-12 15:29:06,662 - AuditReportLogger - INFO - main.run_audit_report:24 - 
--- [步骤 1/4] 执行数据提取 ---
2025-07-12 15:29:06,662 - AuditReportLogger - INFO - legacy_runner.run_legacy_extraction:21 - --- 开始执行【最终修复版 V4】数据提取流程 ---
2025-07-12 15:29:06,662 - AuditReportLogger - INFO - mapping_loader.load_mapping_file:60 - --- 开始使用原始逻辑精确解析 mapping_file.xlsx ---
2025-07-12 15:29:06,737 - AuditReportLogger - INFO - mapping_loader.load_mapping_file:99 - --- mapping_file.xlsx 解析完成 ---
2025-07-12 15:29:06,807 - AuditReportLogger - INFO - legacy_runner.run_legacy_extraction:42 - --- [Pass 1/2] 正在处理所有资产负债表... ---
2025-07-12 15:29:06,808 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:11 - --- 开始处理资产负债表: '2019资产负债表' (使用'全局扫描'逻辑) ---
2025-07-12 15:29:06,809 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:49 - --- 资产负债表 '2019资产负债表' 处理完成，生成 54 条记录。---
2025-07-12 15:29:06,811 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:11 - --- 开始处理资产负债表: '2020资产负债表' (使用'全局扫描'逻辑) ---
2025-07-12 15:29:06,812 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:49 - --- 资产负债表 '2020资产负债表' 处理完成，生成 54 条记录。---
2025-07-12 15:29:06,813 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:11 - --- 开始处理资产负债表: '2021资产负债表' (使用'全局扫描'逻辑) ---
2025-07-12 15:29:06,815 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:49 - --- 资产负债表 '2021资产负债表' 处理完成，生成 54 条记录。---
2025-07-12 15:29:06,816 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:11 - --- 开始处理资产负债表: '2022资产负债表' (使用'全局扫描'逻辑) ---
2025-07-12 15:29:06,817 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:49 - --- 资产负债表 '2022资产负债表' 处理完成，生成 54 条记录。---
2025-07-12 15:29:06,819 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:11 - --- 开始处理资产负债表: '2023资产负债表' (使用'全局扫描'逻辑) ---
2025-07-12 15:29:06,820 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:49 - --- 资产负债表 '2023资产负债表' 处理完成，生成 54 条记录。---
2025-07-12 15:29:06,821 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:11 - --- 开始处理资产负债表: '2024资产负债表' (使用'全局扫描'逻辑) ---
2025-07-12 15:29:06,822 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:49 - --- 资产负债表 '2024资产负债表' 处理完成，生成 54 条记录。---
2025-07-12 15:29:06,824 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:11 - --- 开始处理资产负债表: '2025资产负债表' (使用'全局扫描'逻辑) ---
2025-07-12 15:29:06,826 - AuditReportLogger - INFO - balance_sheet_processor.process_balance_sheet:49 - --- 资产负债表 '2025资产负债表' 处理完成，生成 54 条记录。---
2025-07-12 15:29:06,827 - AuditReportLogger - INFO - legacy_runner.run_legacy_extraction:68 - --- [Pass 2/2] 正在处理所有业务活动表... ---
2025-07-12 15:29:06,828 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:11 - --- 开始处理业务活动表: '2019业务活动表' (使用最终版宽容设计) ---
2025-07-12 15:29:06,828 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:70 - 自动计算'净资产变动额'完成，值为: -242749.75
2025-07-12 15:29:06,828 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:72 - --- 业务活动表 '2019业务活动表' 处理完成，最终生成 16 条记录。---
2025-07-12 15:29:06,829 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:11 - --- 开始处理业务活动表: '2020业务活动表' (使用最终版宽容设计) ---
2025-07-12 15:29:06,829 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:70 - 自动计算'净资产变动额'完成，值为: 188584.4800000002
2025-07-12 15:29:06,829 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:72 - --- 业务活动表 '2020业务活动表' 处理完成，最终生成 16 条记录。---
2025-07-12 15:29:06,829 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:11 - --- 开始处理业务活动表: '2021业务活动表' (使用最终版宽容设计) ---
2025-07-12 15:29:06,830 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:70 - 自动计算'净资产变动额'完成，值为: -190852.41000000015
2025-07-12 15:29:06,830 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:72 - --- 业务活动表 '2021业务活动表' 处理完成，最终生成 16 条记录。---
2025-07-12 15:29:06,830 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:11 - --- 开始处理业务活动表: '2022业务活动表' (使用最终版宽容设计) ---
2025-07-12 15:29:06,830 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:70 - 自动计算'净资产变动额'完成，值为: 49802.64000000013
2025-07-12 15:29:06,831 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:72 - --- 业务活动表 '2022业务活动表' 处理完成，最终生成 16 条记录。---
2025-07-12 15:29:06,831 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:11 - --- 开始处理业务活动表: '2023业务活动表' (使用最终版宽容设计) ---
2025-07-12 15:29:06,831 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:70 - 自动计算'净资产变动额'完成，值为: 385726.20999999996
2025-07-12 15:29:06,832 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:72 - --- 业务活动表 '2023业务活动表' 处理完成，最终生成 16 条记录。---
2025-07-12 15:29:06,832 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:11 - --- 开始处理业务活动表: '2024业务活动表' (使用最终版宽容设计) ---
2025-07-12 15:29:06,832 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:70 - 自动计算'净资产变动额'完成，值为: -99720.63000000012
2025-07-12 15:29:06,832 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:72 - --- 业务活动表 '2024业务活动表' 处理完成，最终生成 16 条记录。---
2025-07-12 15:29:06,832 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:11 - --- 开始处理业务活动表: '2025业务活动表' (使用最终版宽容设计) ---
2025-07-12 15:29:06,833 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:70 - 自动计算'净资产变动额'完成，值为: -207671.1399999999
2025-07-12 15:29:06,833 - AuditReportLogger - INFO - income_statement_processor.process_income_statement:72 - --- 业务活动表 '2025业务活动表' 处理完成，最终生成 16 条记录。---
2025-07-12 15:29:06,836 - AuditReportLogger - INFO - legacy_runner.run_legacy_extraction:98 - --- 数据提取流程结束，成功生成包含 490 条记录的DataFrame。---
2025-07-12 15:29:06,836 - AuditReportLogger - INFO - main.run_audit_report:29 - ✅ 数据提取成功！
2025-07-12 15:29:06,836 - AuditReportLogger - INFO - main.run_audit_report:32 - 
--- [步骤 2/4] 执行数据处理与计算 ---
2025-07-12 15:29:06,836 - AuditReportLogger - INFO - data_processor.pivot_and_clean_data:8 - 开始进行数据透视和清理...
2025-07-12 15:29:06,847 - AuditReportLogger - INFO - data_processor._pivot:25 - 普通科目数据透视完成。
2025-07-12 15:29:06,855 - AuditReportLogger - INFO - data_processor._pivot:25 - 合计科目数据透视完成。
2025-07-12 15:29:06,855 - AuditReportLogger - INFO - data_processor.pivot_and_clean_data:29 - 数据透视和清理完成。
2025-07-12 15:29:06,856 - AuditReportLogger - INFO - main.run_audit_report:36 - ✅ 数据透视与清理成功！
2025-07-12 15:29:06,856 - AuditReportLogger - INFO - data_processor.calculate_summary_values:38 - 开始计算最终汇总指标...
2025-07-12 15:29:06,856 - AuditReportLogger - INFO - data_processor.calculate_summary_values:56 - 数据期间为: 2019 年至 2025 年。
2025-07-12 15:29:06,859 - AuditReportLogger - INFO - data_processor.calculate_summary_values:98 - 资产、负债、净资产指标计算完成。
2025-07-12 15:29:06,861 - AuditReportLogger - INFO - data_processor.calculate_summary_values:103 - 收入、费用、结余指标计算完成。
2025-07-12 15:29:06,861 - AuditReportLogger - INFO - data_processor.calculate_summary_values:105 - 所有汇总指标计算完成。
2025-07-12 15:29:06,861 - AuditReportLogger - INFO - main.run_audit_report:41 - ✅ 最终汇总指标计算成功！
2025-07-12 15:29:06,861 - AuditReportLogger - INFO - main.run_audit_report:44 - 
--- [步骤 3/4] 执行数据复核 ---
2025-07-12 15:29:06,861 - AuditReportLogger - INFO - mapping_loader.load_mapping_file:60 - --- 开始使用原始逻辑精确解析 mapping_file.xlsx ---
2025-07-12 15:29:06,935 - AuditReportLogger - INFO - mapping_loader.load_mapping_file:99 - --- mapping_file.xlsx 解析完成 ---
2025-07-12 15:29:06,935 - AuditReportLogger - INFO - data_validator.run_all_checks:6 - --- [复核机制] 开始执行所有数据检查... ---
2025-07-12 15:29:06,936 - AuditReportLogger - INFO - data_validator.run_all_checks:19 -   -> 正在执行: 业务活动表内部分项核对...
2025-07-12 15:29:06,936 - AuditReportLogger - INFO - data_validator.run_all_checks:31 -   -> 正在执行: 核心勾稽关系检查...
2025-07-12 15:29:06,937 - AuditReportLogger - INFO - data_validator.run_all_checks:34 - --- [复核机制] 所有数据检查执行完毕。 ---
2025-07-12 15:29:06,937 - AuditReportLogger - INFO - main.run_audit_report:48 - ✅ 数据复核完成！
2025-07-12 15:29:06,938 - AuditReportLogger - INFO - main.run_audit_report:51 - 
--- [步骤 4/4] 展示最终计算结果与复核报告 ---
2025-07-12 15:29:06,940 - AuditReportLogger - INFO - main.run_audit_report:62 - 
========================================
2025-07-12 15:29:06,940 - AuditReportLogger - INFO - main.run_audit_report:63 - ===         流程执行完毕           ===
2025-07-12 15:29:06,940 - AuditReportLogger - INFO - main.run_audit_report:64 - ========================================
